<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 LOGISTIC REGRESSION | Modeling HCV Data - Classification Models</title>
  <meta name="description" content="4 LOGISTIC REGRESSION | Modeling HCV Data - Classification Models" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="4 LOGISTIC REGRESSION | Modeling HCV Data - Classification Models" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 LOGISTIC REGRESSION | Modeling HCV Data - Classification Models" />
  
  
  

<meta name="author" content="John Koomson, FSA, MAAA" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="dataanalysis.html"/>
<link rel="next" href="fitting-random-forest.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Modeling HCV Data</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Models</a></li>
<li class="chapter" data-level="2" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>2</b> Data Cleaning</a></li>
<li class="chapter" data-level="3" data-path="dataanalysis.html"><a href="dataanalysis.html"><i class="fa fa-check"></i><b>3</b> Exploratory Data Analysis</a>
<ul>
<li class="chapter" data-level="3.1" data-path="dataanalysis.html"><a href="dataanalysis.html#findings"><i class="fa fa-check"></i><b>3.1</b> FINDINGS</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>4</b> LOGISTIC REGRESSION</a>
<ul>
<li class="chapter" data-level="4.1" data-path="logistic-regression.html"><a href="logistic-regression.html#data-partitioning"><i class="fa fa-check"></i><b>4.1</b> Data Partitioning</a></li>
<li class="chapter" data-level="4.2" data-path="logistic-regression.html"><a href="logistic-regression.html#fold-cross-validation---logistic-regression"><i class="fa fa-check"></i><b>4.2</b> 5-Fold Cross Validation - Logistic Regression</a></li>
<li class="chapter" data-level="4.3" data-path="logistic-regression.html"><a href="logistic-regression.html#fitting-the-best-model"><i class="fa fa-check"></i><b>4.3</b> Fitting the Best Model</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="fitting-random-forest.html"><a href="fitting-random-forest.html"><i class="fa fa-check"></i><b>5</b> FITTING RANDOM FOREST</a></li>
<li class="chapter" data-level="6" data-path="v-folds-for-multivariate-adaptive-regression-splines.html"><a href="v-folds-for-multivariate-adaptive-regression-splines.html"><i class="fa fa-check"></i><b>6</b> V-FOLDS FOR MULTIVARIATE ADAPTIVE REGRESSION SPLINES</a></li>
<li class="chapter" data-level="7" data-path="v-folds-for-artificial-neural-networks-1.html"><a href="v-folds-for-artificial-neural-networks-1.html"><i class="fa fa-check"></i><b>7</b> V-Folds for Artificial Neural Networks 1</a></li>
<li class="chapter" data-level="8" data-path="artificial-neural-network-2v-folds-for-the-second-ann.html"><a href="artificial-neural-network-2v-folds-for-the-second-ann.html"><i class="fa fa-check"></i><b>8</b> ARTIFICIAL NEURAL NETWORK 2(V-FOLDS FOR THE SECOND ANN)</a></li>
<li class="chapter" data-level="9" data-path="v--folds-for-support-vector-machine-1.html"><a href="v--folds-for-support-vector-machine-1.html"><i class="fa fa-check"></i><b>9</b> V- folds for SUPPORT VECTOR MACHINE 1</a></li>
<li class="chapter" data-level="10" data-path="table-of-average-auc-for-v-fold-of-each-classifier.html"><a href="table-of-average-auc-for-v-fold-of-each-classifier.html"><i class="fa fa-check"></i><b>10</b> TABLE OF AVERAGE AUC FOR V FOLD OF EACH CLASSIFIER</a></li>
<li class="divider"></li>
<li><a href="https://github.com/JohnATMill/modeling_hcv_data.git" target="blank">Github Code</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Modeling HCV Data - Classification Models</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="logistic-regression" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">4</span> LOGISTIC REGRESSION<a href="logistic-regression.html#logistic-regression" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="data-partitioning" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Data Partitioning<a href="logistic-regression.html#data-partitioning" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="logistic-regression.html#cb14-1" aria-hidden="true" tabindex="-1"></a>data<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">&quot;data/CleanedData.csv&quot;</span>,<span class="at">header =</span> T,<span class="at">colClasses=</span><span class="fu">c</span>(<span class="st">&quot;NULL&quot;</span>, <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">13</span>))) </span>
<span id="cb14-2"><a href="logistic-regression.html#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="logistic-regression.html#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">125</span>)</span>
<span id="cb14-4"><a href="logistic-regression.html#cb14-4" aria-hidden="true" tabindex="-1"></a>V <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb14-5"><a href="logistic-regression.html#cb14-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">NROW</span>(data); n0 <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>Category<span class="sc">==</span><span class="dv">0</span>); n1 <span class="ot">=</span> n<span class="sc">-</span>n0;</span>
<span id="cb14-6"><a href="logistic-regression.html#cb14-6" aria-hidden="true" tabindex="-1"></a>id.fold <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span>n</span>
<span id="cb14-7"><a href="logistic-regression.html#cb14-7" aria-hidden="true" tabindex="-1"></a>id.fold[data<span class="sc">$</span>Category<span class="sc">==</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span>V, <span class="at">size=</span>n0, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb14-8"><a href="logistic-regression.html#cb14-8" aria-hidden="true" tabindex="-1"></a>id.fold[data<span class="sc">$</span>Category<span class="sc">==</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span>V, <span class="at">size=</span>n1, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb14-9"><a href="logistic-regression.html#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (v <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>V) {</span>
<span id="cb14-10"><a href="logistic-regression.html#cb14-10" aria-hidden="true" tabindex="-1"></a>train.v <span class="ot">&lt;-</span> data[id.fold<span class="sc">!=</span>v, ]; test.v <span class="ot">&lt;-</span> data[id.fold<span class="sc">==</span>v, ]</span>
<span id="cb14-11"><a href="logistic-regression.html#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="logistic-regression.html#cb14-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-13"><a href="logistic-regression.html#cb14-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-14"><a href="logistic-regression.html#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(train.v)</span></code></pre></div>
<pre><code>## [1] 553  13</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="logistic-regression.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(test.v)</span></code></pre></div>
<pre><code>## [1] 62 13</code></pre>
</div>
<div id="fold-cross-validation---logistic-regression" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> 5-Fold Cross Validation - Logistic Regression<a href="logistic-regression.html#fold-cross-validation---logistic-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="logistic-regression.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">666</span>)</span>
<span id="cb18-2"><a href="logistic-regression.html#cb18-2" aria-hidden="true" tabindex="-1"></a>V <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb18-3"><a href="logistic-regression.html#cb18-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">NROW</span>(data); n0 <span class="ot">&lt;-</span> <span class="fu">sum</span>(data<span class="sc">$</span>Category<span class="sc">==</span><span class="dv">0</span>); n1 <span class="ot">&lt;-</span> n<span class="sc">-</span>n0;</span>
<span id="cb18-4"><a href="logistic-regression.html#cb18-4" aria-hidden="true" tabindex="-1"></a>missclass.rate <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb18-5"><a href="logistic-regression.html#cb18-5" aria-hidden="true" tabindex="-1"></a>err_vec1<span class="ot">=</span><span class="fu">c</span>()</span>
<span id="cb18-6"><a href="logistic-regression.html#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (v <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>V) {</span>
<span id="cb18-7"><a href="logistic-regression.html#cb18-7" aria-hidden="true" tabindex="-1"></a>  err_vec1<span class="ot">=</span><span class="fu">c</span>(err_vec1, v)</span>
<span id="cb18-8"><a href="logistic-regression.html#cb18-8" aria-hidden="true" tabindex="-1"></a>  missclass.rate<span class="ot">=</span><span class="fu">c</span>(missclass.rate, v)</span>
<span id="cb18-9"><a href="logistic-regression.html#cb18-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-10"><a href="logistic-regression.html#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="logistic-regression.html#cb18-11" aria-hidden="true" tabindex="-1"></a>id.fold <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>n</span>
<span id="cb18-12"><a href="logistic-regression.html#cb18-12" aria-hidden="true" tabindex="-1"></a>id.fold[data<span class="sc">$</span>Category<span class="sc">==</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span>V, <span class="at">size=</span>n0, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb18-13"><a href="logistic-regression.html#cb18-13" aria-hidden="true" tabindex="-1"></a>id.fold[data<span class="sc">$</span>Category<span class="sc">==</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span>V, <span class="at">size=</span>n1, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb18-14"><a href="logistic-regression.html#cb18-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-15"><a href="logistic-regression.html#cb18-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-16"><a href="logistic-regression.html#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (v <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>V) {</span>
<span id="cb18-17"><a href="logistic-regression.html#cb18-17" aria-hidden="true" tabindex="-1"></a>train.v <span class="ot">&lt;-</span> data[id.fold<span class="sc">!=</span>v, ]; test.v <span class="ot">&lt;-</span> data[id.fold<span class="sc">==</span>v, ];</span>
<span id="cb18-18"><a href="logistic-regression.html#cb18-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-19"><a href="logistic-regression.html#cb18-19" aria-hidden="true" tabindex="-1"></a>formula0 <span class="ot">=</span> Category<span class="sc">~</span>.</span>
<span id="cb18-20"><a href="logistic-regression.html#cb18-20" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">model.matrix</span> (<span class="fu">as.formula</span>(formula0), <span class="at">data =</span> train.v)</span>
<span id="cb18-21"><a href="logistic-regression.html#cb18-21" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">factor</span>(train.v<span class="sc">$</span>Category)</span>
<span id="cb18-22"><a href="logistic-regression.html#cb18-22" aria-hidden="true" tabindex="-1"></a>fit.lasso <span class="ot">=</span> <span class="fu">glmnet</span>(<span class="at">x=</span>X, <span class="at">y=</span>y, <span class="at">family=</span><span class="st">&quot;binomial&quot;</span>, <span class="at">alpha=</span><span class="dv">1</span>, </span>
<span id="cb18-23"><a href="logistic-regression.html#cb18-23" aria-hidden="true" tabindex="-1"></a>                    <span class="at">lambda.min =</span> <span class="fl">1e-4</span>, <span class="at">nlambda =</span> <span class="dv">100</span>, <span class="at">standardize=</span>T, <span class="at">thresh =</span> </span>
<span id="cb18-24"><a href="logistic-regression.html#cb18-24" aria-hidden="true" tabindex="-1"></a>                      <span class="fl">1e-07</span>, <span class="at">maxit=</span><span class="dv">1000</span>)</span>
<span id="cb18-25"><a href="logistic-regression.html#cb18-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-26"><a href="logistic-regression.html#cb18-26" aria-hidden="true" tabindex="-1"></a>CV <span class="ot">=</span> <span class="fu">cv.glmnet</span>(<span class="at">x=</span>X, <span class="at">y=</span>y, <span class="at">family=</span><span class="st">&quot;binomial&quot;</span>, <span class="at">alpha =</span> <span class="dv">1</span>,</span>
<span id="cb18-27"><a href="logistic-regression.html#cb18-27" aria-hidden="true" tabindex="-1"></a>               <span class="at">lambda.min =</span> <span class="fl">1e-4</span>, <span class="at">nlambda =</span> <span class="dv">200</span>, <span class="at">standardize =</span> T,</span>
<span id="cb18-28"><a href="logistic-regression.html#cb18-28" aria-hidden="true" tabindex="-1"></a>               <span class="at">thresh =</span> <span class="fl">1e-07</span>, <span class="at">maxit=</span><span class="dv">1000</span>)</span>
<span id="cb18-29"><a href="logistic-regression.html#cb18-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-30"><a href="logistic-regression.html#cb18-30" aria-hidden="true" tabindex="-1"></a>best.lambda <span class="ot">=</span> CV<span class="sc">$</span>lambda<span class="fl">.1</span>se; <span class="co">#best.lambda  </span></span>
<span id="cb18-31"><a href="logistic-regression.html#cb18-31" aria-hidden="true" tabindex="-1"></a>fit.best <span class="ot">=</span> <span class="fu">glmnet</span>(<span class="at">x=</span>X, <span class="at">y=</span>y, <span class="at">family=</span><span class="st">&quot;binomial&quot;</span>, <span class="at">alpha =</span> <span class="dv">1</span>,</span>
<span id="cb18-32"><a href="logistic-regression.html#cb18-32" aria-hidden="true" tabindex="-1"></a>                  <span class="at">lambda=</span>best.lambda, <span class="at">standardize =</span> T, </span>
<span id="cb18-33"><a href="logistic-regression.html#cb18-33" aria-hidden="true" tabindex="-1"></a>                  <span class="at">thresh =</span> <span class="fl">1e-07</span>, <span class="at">maxit=</span><span class="dv">1000</span>)</span>
<span id="cb18-34"><a href="logistic-regression.html#cb18-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-35"><a href="logistic-regression.html#cb18-35" aria-hidden="true" tabindex="-1"></a>formula0 <span class="ot">=</span> Category <span class="sc">~</span>. <span class="co"># ALP + AST + BIL + CHOL + CREA + GGT + PROT</span></span>
<span id="cb18-36"><a href="logistic-regression.html#cb18-36" aria-hidden="true" tabindex="-1"></a>fit.final <span class="ot">=</span> <span class="fu">glm</span>(formula0, <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>, <span class="at">data =</span> train.v)</span>
<span id="cb18-37"><a href="logistic-regression.html#cb18-37" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(fit.final)</span></span>
<span id="cb18-38"><a href="logistic-regression.html#cb18-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-39"><a href="logistic-regression.html#cb18-39" aria-hidden="true" tabindex="-1"></a>yobs <span class="ot">=</span> test.v<span class="sc">$</span>Category</span>
<span id="cb18-40"><a href="logistic-regression.html#cb18-40" aria-hidden="true" tabindex="-1"></a>X.test <span class="ot">=</span> test.v[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb18-41"><a href="logistic-regression.html#cb18-41" aria-hidden="true" tabindex="-1"></a>pred.glm <span class="ot">=</span> <span class="fu">predict</span>(fit.final, <span class="at">newdata =</span> X.test, <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb18-42"><a href="logistic-regression.html#cb18-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-43"><a href="logistic-regression.html#cb18-43" aria-hidden="true" tabindex="-1"></a><span class="co">#X.test &lt;- model.matrix (as.formula(formula0), data = test.v)</span></span>
<span id="cb18-44"><a href="logistic-regression.html#cb18-44" aria-hidden="true" tabindex="-1"></a><span class="co">#pred.glm &lt;- predict(fit.best, newx = X.test, s=best.lambda, type=&quot;response&quot;)</span></span>
<span id="cb18-45"><a href="logistic-regression.html#cb18-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-46"><a href="logistic-regression.html#cb18-46" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">=</span> <span class="fu">roc.area</span>(yobs, pred.glm)<span class="sc">$</span>A</span>
<span id="cb18-47"><a href="logistic-regression.html#cb18-47" aria-hidden="true" tabindex="-1"></a>err_vec1[v] <span class="ot">=</span> mod</span>
<span id="cb18-48"><a href="logistic-regression.html#cb18-48" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC for fold&quot;</span>, v, <span class="st">&quot;:&quot;</span>, err_vec1[v]))</span>
<span id="cb18-49"><a href="logistic-regression.html#cb18-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-50"><a href="logistic-regression.html#cb18-50" aria-hidden="true" tabindex="-1"></a>pred.rate <span class="ot">=</span> <span class="fu">ifelse</span>(pred.glm <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb18-51"><a href="logistic-regression.html#cb18-51" aria-hidden="true" tabindex="-1"></a>miss.rate <span class="ot">&lt;-</span> <span class="fu">mean</span>(yobs <span class="sc">!=</span> pred.rate)</span>
<span id="cb18-52"><a href="logistic-regression.html#cb18-52" aria-hidden="true" tabindex="-1"></a>missclass.rate[v] <span class="ot">=</span> miss.rate</span>
<span id="cb18-53"><a href="logistic-regression.html#cb18-53" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Missclassification rate for fold&quot;</span>, v,</span>
<span id="cb18-54"><a href="logistic-regression.html#cb18-54" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;:&quot;</span>,missclass.rate[v]))</span>
<span id="cb18-55"><a href="logistic-regression.html#cb18-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-56"><a href="logistic-regression.html#cb18-56" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;AUC for fold 1 : 0.986036036036036&quot;
## [1] &quot;Missclassification rate for fold 1 : 0.0229007633587786&quot;
## [1] &quot;AUC for fold 2 : 0.98735119047619&quot;
## [1] &quot;Missclassification rate for fold 2 : 0.0403225806451613&quot;
## [1] &quot;AUC for fold 3 : 0.961974110032362&quot;
## [1] &quot;Missclassification rate for fold 3 : 0.0434782608695652&quot;
## [1] &quot;AUC for fold 4 : 0.992745535714286&quot;
## [1] &quot;Missclassification rate for fold 4 : 0.03125&quot;
## [1] &quot;AUC for fold 5 : 0.862745098039216&quot;
## [1] &quot;Missclassification rate for fold 5 : 0.0512820512820513&quot;</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="logistic-regression.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.final)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = formula0, family = &quot;binomial&quot;, data = train.v)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -4.6717  -0.1394  -0.0592  -0.0182   2.4267  
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -16.446702   5.597463  -2.938 0.003301 ** 
## Age           0.004660   0.028344   0.164 0.869407    
## Sexm         -0.823760   0.743006  -1.109 0.267566    
## ALB          -0.184515   0.080182  -2.301 0.021380 *  
## ALP          -0.093058   0.021085  -4.413 1.02e-05 ***
## ALT          -0.021020   0.012909  -1.628 0.103451    
## AST           0.086780   0.021528   4.031 5.55e-05 ***
## BIL           0.078482   0.032325   2.428 0.015186 *  
## CHE           0.158411   0.161415   0.981 0.326402    
## CHOL         -1.208569   0.369956  -3.267 0.001088 ** 
## CREA          0.026601   0.007313   3.637 0.000275 ***
## GGT           0.031680   0.007297   4.342 1.41e-05 ***
## PROT          0.342237   0.093626   3.655 0.000257 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 366.413  on 497  degrees of freedom
## Residual deviance:  85.039  on 485  degrees of freedom
## AIC: 111.04
## 
## Number of Fisher Scoring iterations: 8</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="logistic-regression.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(CV)</span></code></pre></div>
<p><img src="HCV_MODELLINGr_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p><em>COMMENT</em>
We can see that the best parameter lambda is</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="logistic-regression.html#cb23-1" aria-hidden="true" tabindex="-1"></a>Average.AUC.logis<span class="ot">&lt;-</span><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Average of AUC:&quot;</span>, <span class="fu">mean</span>(err_vec1)))</span></code></pre></div>
<pre><code>## [1] &quot;Average of AUC: 0.958170394059618&quot;</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="logistic-regression.html#cb25-1" aria-hidden="true" tabindex="-1"></a>Average.miss.logis<span class="ot">&lt;-</span><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Average of Miss:&quot;</span>, <span class="fu">mean</span>(missclass.rate)))</span></code></pre></div>
<pre><code>## [1] &quot;Average of Miss: 0.0378467312311113&quot;</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="logistic-regression.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit.best<span class="sc">$</span>beta)</span></code></pre></div>
<pre><code>## 13 x 1 sparse Matrix of class &quot;dgCMatrix&quot;
##                        s0
## (Intercept)  .           
## Age          .           
## Sexm         .           
## ALB          .           
## ALP         -0.0356445268
## ALT         -0.0004724408
## AST          0.0424183660
## BIL          0.0194239225
## CHE          .           
## CHOL        -0.4125065706
## CREA         0.0048351158
## GGT          0.0127957625
## PROT         0.0488338650</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="logistic-regression.html#cb29-1" aria-hidden="true" tabindex="-1"></a>best.lambda</span></code></pre></div>
<pre><code>## [1] 0.01501008</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="logistic-regression.html#cb31-1" aria-hidden="true" tabindex="-1"></a>AUC.LOGIS<span class="ot">&lt;-</span><span class="fu">mean</span>(err_vec1)</span>
<span id="cb31-2"><a href="logistic-regression.html#cb31-2" aria-hidden="true" tabindex="-1"></a>miss.rate.LOIS<span class="ot">&lt;-</span><span class="fu">mean</span>(missclass.rate)</span></code></pre></div>
</div>
<div id="fitting-the-best-model" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Fitting the Best Model<a href="logistic-regression.html#fitting-the-best-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="logistic-regression.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit.final)</span></code></pre></div>
<p><img src="HCV_MODELLINGr_files/figure-html/unnamed-chunk-19-1.png" width="672" /><img src="HCV_MODELLINGr_files/figure-html/unnamed-chunk-19-2.png" width="672" /><img src="HCV_MODELLINGr_files/figure-html/unnamed-chunk-19-3.png" width="672" /><img src="HCV_MODELLINGr_files/figure-html/unnamed-chunk-19-4.png" width="672" /></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="logistic-regression.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">#fit.best$beta</span></span>
<span id="cb33-2"><a href="logistic-regression.html#cb33-2" aria-hidden="true" tabindex="-1"></a>final.fit<span class="ot">&lt;-</span><span class="fu">glm</span>(train.v<span class="sc">$</span>Category<span class="sc">~</span>ALP<span class="sc">+</span>ALT<span class="sc">+</span>AST<span class="sc">+</span>BIL<span class="sc">+</span>CHOL<span class="sc">+</span>CREA<span class="sc">+</span>GGT<span class="sc">+</span>PROT, <span class="at">family =</span> (<span class="at">link =</span>  <span class="st">&quot;binomial&quot;</span>), <span class="at">data =</span> train.v)</span></code></pre></div>
<pre><code>## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
<p><strong>comment</strong></p>
<p>Cross validation is used to select the best tuning parameter for the logistic regression.We can observe that the best lambda is 0.0204.We can also observe that,the coefficient(ALP,AST and CHOL) are all negative and thus have been shrunk to 0.Thus,we are left with the variables with the positive values.Also,we can observe that all the values the parameters with positive coefficient are statistically significant.</p>
<p><em>Average of AUC and Missclassification Rate;</em></p>
<p>We can observe that the average of the AUC from the V-folds is approximately 0.96 and misclassification of 0.04.This shows that model was good in making correct with predictions.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="dataanalysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="fitting-random-forest.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": "none",
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true,
"toolbar": "fixed"
},
"info": true
});
});
</script>

</body>

</html>
